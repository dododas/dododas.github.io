---
title: Simulating colorblindness
date: 2020-01-21T21:29:57-05:00
draft: True
katex: True
---

## Introduction 

This is the first post in a series on simulating colorblindness. The objective is to transform an input color image to represent how it *most likely* appears to a colorblind person. This post explains the transformation algorithm.

![Color mosaic](/images/colorblind-sim/brettel-fig3.png)
**Fig. 1** (a) A color mosaic, and its transform for (b) a protanope, (c) a deuteranope, and (d) a tritanope [Source: Brettel et al (Fig. 3)]

## Key ideas

Color perception | Types of cones | Types of colorblindness | Cone fundamentals | LMS representation | Metamers | RGB color | Gamut |

{{< columns >}}
**Color vision**: Color is sensed by cone cells in the retina of the eye. There are 3 types of cone cells: S, M and L, that are sensitive to **s**hort, **m**edium and **l**ong wavelengths of visible light. Cone sensitivities to different wavelengths has been experimentally measured. For example see Fig. 12 from Stockman et al (1993) that shows how each cone type absorbs light of different wavelengths. 

Given a signal $f(\lambda)$, the integrated response for each cone type is given by the expressions:
$$ \begin{aligned} 
L & = \int f(\lambda) \cdot l(\lambda)\ d \lambda \\\ 
M & = \int f(\lambda) \cdot m(\lambda)\ d \lambda \\\ 
S & = \int f(\lambda) \cdot s(\lambda)\ d \lambda 
\end{aligned} $$

<--->

![Spectral sensitivities](/images/colorblind-sim/stockman-fig-12-spectra.png)
{{< /columns >}}

where $f(\lambda)$ is the power spectrum of the signal, and $l()$, $m()$ and $s()$ are the sensitivities of each cone type. Any color can be represented in this **tristimulus** space $q = [L; M; S]$. 

**Metamers**: Due to the broad and overlapping sensitivities of the three cone types, the tristimulus representation is not unique. It is possible that two signals $f$ and $g$ produce the same tristimulus response, and therefore appear identical to the eye despite their different power distributions. Such signals (colors) are called metamers. 

**Colorblindness**: The loss of a cone type results in defective color vision, or colorblindness. There are three types of colorblindness - *protanopia*, the loss of L cones, *deuteranopia*, the loss of M cones, and *tritanopia*, the loss of S cones. The first two are variants of red-green colorblindness.

**Color display**: On a digital monitor, color is represented using an RGB model which uses the three components $(r, g, b)$ to denote the intensity of the red, green and blue channels, respectively. 

## Algorithm

**Overview**: The algorithm is given an input RGB image $I$. It produces three output images $O_1$, $O_2$ and $O_3$ that represent how the image I appears to a protanope, a deuteranope and a tritanope, respectively (see Fig. 1). Each output image is generated by applying a pixel-by-pixel transformation to the colors of the original image. Specifically, given $v = (r, g, b)$, the intensity of a pixel in the input image:

1. Convert to LMS: $q = T \cdot v$
2. Apply colorblindness transform: $q \rightarrow q'$
3. Convert to RGB: $v ' = T^{-1} \cdot q'$

**Colorblindness transform**: The transform replaces one component of the vector $q$ by its **projection** on to a plane that represents the restricted stimulus space for a colorblind person. 

## References

1. **Computerized simulation of color appearance for dichromats**, Hans Brettel, Françoise Viénot and John D. Mollon, *J. Opt. Soc. Am. A*, **14**,  2647-55 (1997)

2. **Spectral sensitivities of the human cones**, Andrew Stockman, Donald I. A. MacLeod, and Nancy E. Johnson, *J. Opt. Soc. Am. A*, **10**, 2491-2521 (1993)
